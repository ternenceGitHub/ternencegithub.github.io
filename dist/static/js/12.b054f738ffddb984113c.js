webpackJsonp([12],{"4U6r":function(t,e){},"8Y2p":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("UIuv"),i=n.n(a),o=n("awcp"),c=n.n(o),r=n("MCtw"),s=n.n(r),u=n("R2EP"),l=n.n(u),d=n("GW0m"),f=n.n(d),v=n("yd8V"),h=n.n(v),m=n("7mmR"),p=n.n(m),g=n("SQai"),_=n.n(g),y=n("Sxqw"),A=n.n(y),b=n("/Ko3"),k=n.n(b),S=n("26vW"),C=n.n(S),w=n("DK4l"),x=n.n(w),D=n("FYbq"),I=n.n(D),N=n("ODIp"),M=n.n(N),F=n("P7rZ"),R=n.n(F),P=n("XMzP"),$=n.n(P),O=n("Np5n"),z=I.a.Item,L={props:{activeCode:String},components:{AModal:k.a,ATable:C.a,AButton:x.a,AIcon:l.a,AForm:I.a,AFormItem:z,AInput:M.a,ADivider:R.a,APopconfirm:$.a,ATooltip:p.a},data:function(){return{maskClosable:!1,visible:!1,confirmLoading:!1,pagination:{showQuickJumper:!0,pageSize:5},columns:[{title:"账号状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}}],data:[],cols:[""]}},beforeCreate:function(){this.form=this.$form.createForm(this)},methods:{editInsuranceAccountToServer:function(t){return new i.a(function(e,n){Object(O.b)(t).then(function(t){e(t)}).catch(function(t){n(t)})})},addInsuranceAccountToServer:function(t){var e=this;return new i.a(function(n,a){Object(O.a)(t).then(function(t){n(t)}).catch(function(t){e.$myNotification.sendFailedNotification(t),a(t)})})},showModal:function(t){this.visible=!0;var e=t.account_param,n=t.accounts;this.getColumns(e),this.getData(n)},getColumns:function(t){for(var e in t)this.columns.push({title:t[e].name,dataIndex:t[e].key,key:t[e].key,scopedSlots:{customRender:t[e].key}}),this.cols.push(t[e].key);this.columns.push({title:"操作",key:"operation",scopedSlots:{customRender:"operation"}})},getData:function(t){t.forEach(function(t,e){t.key=e,t.editable=!1}),this.data=t},handleOk:function(t){var e=this;this.confirmLoading=!0,setTimeout(function(){e.visible=!1,e.confirmLoading=!1},2e3),this.resetPrivateAccount()},handleCancel:function(t){this.visible=!1,this.resetPrivateAccount()},handleSubmit:function(t){t.preventDefault(),this.validate()},newMember:function(){var t={editable:!0,isNew:!0,key:this.data.length+1,status:""};this.cols.forEach(function(e){""!=e&&(t[e]="")}),this.data.unshift(t)},remove:function(t){var e=this.data.filter(function(e){return e.key!==t});this.data=e},saveRow:function(t){var e=this.data.filter(function(e){return e.key===t})[0],n={};for(var a in n.insurance=this.$props.activeCode,e)"editable"!=a&&"isNew"!=a&&"key"!=a&&"status"!=a&&("username"==a?n.account=e[a]:n[a]=e[a]);e.isNew?this.addInsuranceAccountToServer(n).then(function(t){e.editable=!1,e.isNew=!1}).catch(function(t){}):this.editInsuranceAccountToServer(n).then(function(t){e.editable=!1}).catch(function(t){})},toggle:function(t){var e=this.data.filter(function(e){return e.key===t})[0];e.editable=!e.editable,this.data.sort(function(t,e){return e-t})},getRowByKey:function(t,e){var n=this.data;return(e||n).filter(function(e){return e.key===t})[0]},cancel:function(t){this.data.filter(function(e){return e.key===t})[0].editable=!1,this.data.sort(function(t,e){return e-t})},handleChange:function(t,e,n){var a=[].concat(A()(this.data)),i=a.filter(function(t){return e===t.key})[0];i&&(i[n]=t,this.data=a)},resetPrivateAccount:function(){this.columns=[{title:"账号状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}}],this.cols=[""],this.$emit("resetPrivateAccount")}}},T={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"private-account-modal"},[n("a-modal",{attrs:{title:"自有账号详情",visible:t.visible,maskClosable:t.maskClosable,confirmLoading:t.confirmLoading,width:"908px"},on:{ok:t.handleOk,cancel:t.handleCancel}},[n("form",{attrs:{form:t.form}},[n("a-button",{staticStyle:{width:"100%","margin-top":"8px","margin-bottom":"16px"},attrs:{type:"dashed",icon:"plus"},on:{click:t.newMember}},[t._v("新增成员")]),t._v(" "),n("a-table",{attrs:{columns:t.columns,dataSource:t.data,pagination:t.pagination,scroll:{x:861}},scopedSlots:t._u([t._l(t.cols,function(e,a){return{key:e,fn:function(i,o,c){return[o.editable?n("a-input",{key:e,staticStyle:{margin:"-5px 0","min-width":"90px"},attrs:{value:i,placeholder:t.columns[a].title},on:{change:function(n){return t.handleChange(n.target.value,o.key,e)}}}):[t._v(t._s(i))]]}}}),{key:"operation",fn:function(e,a,i){return[a.editable?[a.isNew?n("span",[n("a",{on:{click:function(e){return t.saveRow(a.key)}}},[t._v("添加")]),t._v(" "),n("a-divider",{attrs:{type:"vertical"}}),t._v(" "),n("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(e){return t.remove(a.key)}}},[n("a",[t._v("删除")])])],1):n("span",[n("a",{on:{click:function(e){return t.saveRow(a.key)}}},[t._v("保存")]),t._v(" "),n("a-divider",{attrs:{type:"vertical"}}),t._v(" "),n("a",{on:{click:function(e){return t.cancel(a.key)}}},[t._v("取消")])],1)]:n("span",[n("a",{on:{click:function(e){return t.toggle(a.key)}}},[t._v("编辑")]),t._v(" "),n("a-divider",{attrs:{type:"vertical"}}),t._v(" "),n("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(e){return t.remove(a.key)}}},[n("a",[t._v("删除")])])],1)]}}],null,!0)})],1)])],1)},staticRenderFns:[]};var E=n("Mz/3")(L,T,!1,function(t){n("a6Vh")},null,null).exports,j=c.a.Item,U=f.a.Meta,Y={name:"Article",components:{AList:c.a,AListItem:j,ASpin:s.a,AIcon:l.a,ACard:f.a,ACardMeta:U,AAvatar:h.a,ATooltip:p.a,ABadge:_.a,PrivateAccountModal:E},data:function(){return{dataSource:[],loading:!1,privateAccounts:[],activeCode:"",privateAccount:{}}},created:function(){var t=this,e=this;this.loading=!0,this.getCalculateListFromServer().then(function(n){e.dataSource.forEach(function(n,a){var i=n;t.getCalculateDetailFromServer(n.code).then(function(t){i.privateAccountNum=t.accounts.length,e.privateAccounts.push(t),a==e.dataSource.length-1&&(e.loading=!1)})})})},methods:{sendSetDefaultInsuranceToServer:function(t){var e=this;return new i.a(function(n,a){Object(O.f)({insurance:t}).then(function(t){n(t)}).catch(function(t){e.loding=!1,e.$myNotification.sendFailedNotification(t),a(t)})})},getCalculateListFromServer:function(){var t=this;return new i.a(function(e,n){Object(O.d)().then(function(n){n.data.forEach(function(a,i){t.dataSource.push({id:i,name:a.name,isDefault:a.default,code:a.code,avatar:"https://gw.alipayobjects.com/zos/rmsportal/zOsKZmFRdUtvpqCImOVY.png",activeUser:710105136666,privateAccountNum:i}),e(n)})}).catch(function(e){t.loding=!1,t.$myNotification.sendFailedNotification(e),n(e)})})},getCalculateDetailFromServer:function(t){return new i.a(function(e,n){Object(O.c)({insurance:t}).then(function(t){e(t)}).catch(function(t){_this.loding=!1,_this.$myNotification.sendFailedNotification(t),n(t)})})},showAccountModal:function(t){this.privateAccount=this.privateAccounts.filter(function(e){return e.code==t})[0]||{},this.activeCode=t,this.$refs.dialogtreeAccountModal.showModal(this.privateAccount)},setDefault:function(t){var e=this,n=t.target.getAttribute("id"),a=this.dataSource.filter(function(t){return t.id==n}),i=this.dataSource.filter(function(t){return 1==t.isDefault});0!=a.length&&a[0].isDefault!=i[0].isDefault&&this.sendSetDefaultInsuranceToServer(a[0].code||"").then(function(t){i[0].isDefault=!1,a[0].isDefault=!a[0].isDefault,e.$notification.success({message:"已将"+a[0].name+"设置为默认算价器接口"})})},resetPrivateAccount:function(){this.privateAccount={}}}},J={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"content",staticClass:"complicated-card-list"},[n("a-spin",{attrs:{spinning:t.loading}},[n("a-list",{attrs:{grid:{gutter:24,xxl:3,xl:2,md:2,sm:1},dataSource:t.dataSource},scopedSlots:t._u([{key:"renderItem",fn:function(e,a){return n("a-list-item",{},[n("a-card",{attrs:{hoverable:!0}},[n("a-card-meta",[n("div",{staticStyle:{"margin-bottom":"3px"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name))]),t._v(" "),n("div",{staticStyle:{"margin-bottom":"3px",flex:"1","text-align":"right"},attrs:{slot:"title"},slot:"title"},[n("a-icon",{staticStyle:{"font-size":"20px"},style:{color:e.isDefault?"#52c41a":"rgba(0, 0, 0, 0.45)"},attrs:{type:"check-circle"}})],1),t._v(" "),n("a-avatar",{staticClass:"card-avatar",attrs:{slot:"avatar",src:e.avatar,size:"small"},slot:"avatar"}),t._v(" "),n("div",{staticClass:"meta-cardInfo",attrs:{slot:"description"},slot:"description"},[n("div",[n("p",[t._v("可用自有账号数目")]),t._v(" "),n("p",[t._v(t._s(t._f("NumberFormat")(e.privateAccountNum)))])]),t._v(" "),n("div",[n("p",[t._v("临时账号")]),t._v(" "),n("div",[n("a-tooltip",{attrs:{title:e.activeUser}},[n("span",[t._v(t._s(e.activeUser))])]),t._v(" "),n("div",[n("a-badge",{staticStyle:{"margin-left":"10px"},attrs:{status:"success"}}),t._v(" "),n("span",{staticStyle:{"font-size":"14px"}},[t._v("正常")])],1)],1)])])],1),t._v(" "),n("template",{staticClass:"ant-card-actions",slot:"actions"},[n("a",{on:{click:function(n){return t.showAccountModal(e.code)}}},[t._v("\n                  自有账号详情\n                ")]),t._v(" "),n("a",{attrs:{id:e.id},on:{click:function(e){return t.setDefault(e)}}},[t._v(t._s(e.isDefault?"取消设置默认接口":"设置默认接口"))])])],2)],1)}}])}),t._v(" "),this.privateAccounts.length?n("private-account-modal",{ref:"dialogtreeAccountModal",attrs:{activeCode:t.activeCode},on:{resetPrivateAccount:t.resetPrivateAccount}}):t._e()],1)],1)},staticRenderFns:[]};var K={components:{ComplicatedCardList:n("Mz/3")(Y,J,!1,function(t){n("4U6r"),n("e/Wh")},"data-v-66776347",null).exports}},V={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"insurance-settings"},[e("complicated-card-list")],1)},staticRenderFns:[]};var W=n("Mz/3")(K,V,!1,function(t){n("J5NY")},null,null);e.default=W.exports},J5NY:function(t,e){},a6Vh:function(t,e){},"e/Wh":function(t,e){}});
//# sourceMappingURL=12.b054f738ffddb984113c.js.map